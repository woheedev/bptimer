services:
  pocketbase:
    build:
      context: ./apps/pocketbase
      args:
        - VERSION=0.30.4
    container_name: pocketbase
    restart: unless-stopped
    ports:
      - '8090:8090'
    volumes:
      - ./apps/pocketbase/pb_data:/pb_data
      - ./apps/pocketbase/pb_migrations:/pb_migrations
      - ./apps/pocketbase/pb_hooks:/pb_hooks
      # - ./apps/pocketbase/pb_public:/pb_public
    env_file:
      - ./apps/web/.env
    healthcheck:
      test: wget --no-verbose --tries=1 --spider http://localhost:8090/api/health || exit 1
      interval: 30s
      timeout: 5s
      retries: 5
  #cloudflare-tunnel:
  #  image: cloudflare/cloudflared:latest
  #  container_name: cloudflare-tunnel
  #  restart: unless-stopped
  #  command: tunnel run
  #  env_file:
  #    - ./apps/web/.env
